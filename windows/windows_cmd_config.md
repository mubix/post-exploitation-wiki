<!-- Code for collapse and expand -->
<script type="text/javascript"> 
$(document).ready(function() { 
$('div.view').hide(); 
$('div.slide').click(function() {
$(this).next('div.view').slideToggle('fast'); 
return false; 
}); 
}); 
</script>

# Windows CMD Config Commands

Commands that display information about the configuration of the victim and are usually executed from the context of the CMD.exe prompt.

## Misc

### whoami

 * **Command**: `whoami`
 * **Command with arguments**: `whoami /all`
 * **Description**: Lists information about the user you are currently logged in as. Helpful for showing what groups, sid and privileges of this user. Not available in all versions of Windows but is in Windows Vista and more recent. According to [Wikipedia](http://en.wikipedia.org/wiki/Whoami), this command can be added to Windows 2000 using the resource kit and is installed in Windows XP SP2 Support Tools.
 * **Output**:
   * <div class="slide" style="cursor: pointer;"> **Windows 2008:** Show/Hide</div><div class="view"><code>C:\Users\johndoe>whoami<br>lab\johndoe<br><br>C:\Users\johndoe>whoami/all<br><br>USER INFORMATION<br>----------------<br><br>User Name   SID<br>=========== ===========================================<br>lab\johndoe S-1-5-21-60789211-843652525-1994898995-1001<br><br><br>GROUP INFORMATION<br>-----------------<br><br>Group Name                                 Type             SID          Attributes<br>========================================== ================ ============ ==================================================<br>Everyone                                   Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group<br>BUILTIN\Users                              Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group<br>BUILTIN\Administrators                     Alias            S-1-5-32-544 Group used for deny only<br>BUILTIN\Pre-Windows 2000 Compatible Access Alias            S-1-5-32-554 Group used for deny only<br>NT AUTHORITY\INTERACTIVE                   Well-known group S-1-5-4      Mandatory group, Enabled by default, Enabled group<br>NT AUTHORITY\Authenticated Users           Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group<br>NT AUTHORITY\This Organization             Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group<br>LOCAL                                      Well-known group S-1-2-0      Mandatory group, Enabled by default, Enabled group<br>Mandatory Label\Medium Mandatory Level     Unknown SID type S-1-16-8192  Mandatory group, Enabled by default, Enabled group<br><br><br>PRIVILEGES INFORMATION<br>----------------------<br><br>Privilege Name                Description                          State<br>============================= ==================================== ========<br>SeShutdownPrivilege           Shut down the system                 Disabled<br>SeChangeNotifyPrivilege       Bypass traverse checking             Enabled<br>SeUndockPrivilege             Remove computer from docking station Disabled<br>SeIncreaseWorkingSetPrivilege Increase a process working set       Disabled<br>SeTimeZonePrivilege           Change the time zone                 Disabled</code></div>



| Command | Expected Output | Sample Output |
| ------- | --------------- | ------------- |
| `set` | Shows all current environmental variables. Specific ones to look for are USERDOMAIN, USERNAME, USERPROFILE, HOMEPATH, LOGONSERVER, COMPUTERNAME, APPDATA, and ALLUSERPROFILE. | **Win2008** <div class="slide" style="cursor: pointer;">Show/Hide</div><div class="view"><code>C:\Users\johndoe>set<br>ALLUSERSPROFILE=C:\ProgramData<br>APPDATA=C:\Users\johndoe\AppData\Roaming<br>CommonProgramFiles=C:\Program Files\Common Files<br>COMPUTERNAME=WIN-0P19ULL2NB6<br>ComSpec=C:\Windows\system32\cmd.exe<br>DFSTRACINGON=FALSE<br>FP_NO_HOST_CHECK=NO<br>HOMEDRIVE=C:<br>HOMEPATH=\Users\johndoe<br>LOCALAPPDATA=C:\Users\johndoe\AppData\Local<br>LOGONSERVER=\\WIN-0P19ULL2NB6<br>OS=Windows_NT<br>Path=C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem<br>PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC<br>PROCESSOR_ARCHITECTURE=x86<br>PROCESSOR_IDENTIFIER=x86 Family 6 Model 42 Stepping 7, GenuineIntel<br>PROCESSOR_LEVEL=6<br>PROCESSOR_REVISION=2a07<br>ProgramData=C:\ProgramData<br>ProgramFiles=C:\Program Files<br>PROMPT=$P$G<br>PUBLIC=C:\Users\Public<br>SESSIONNAME=Console<br>SystemDrive=C:<br>SystemRoot=C:\Windows<br>TEMP=C:\Users\johndoe\AppData\Local\Temp\1<br>TMP=C:\Users\johndoe\AppData\Local\Temp\1<br>TRACE_FORMAT_SEARCH_PATH=\\winseqfe\release\Windows6.0\lh_sp2rtm\6002.18005.090410-1830\x86fre\symbols.pri\TraceFormat<br>USERDNSDOMAIN=LAB.SKY.NET<br>USERDOMAIN=LAB<br>USERNAME=johndoe<br>USERPROFILE=C:\Users\johndoe<br>windir=C:\Windows</code></div> |
| `fsutil fsinfo drives` | **Must be ADMIN to run this.** Lists the current drives on the system. | **Win2008**  <div class="slide" style="cursor: pointer;">Show/Hide</div><div class="view"><code>C:\Windows\system32>fsutil fsinfo drives<br><br>Drives: A:\ C:\ D:\</code></div> |
| `reg query HKLM /s /d /f "C:\* *.exe"` &#124; `find /I "C:\"` &#124; `find /V """"` | Securely registered executables within the system registry. | **Win2008**  <div class="slide" style="cursor: pointer;">Show/Hide</div><div class="view"><code>C:\Users\johndoe>reg query HKLM /s /d /f "C:\* *.exe" &#124; find /I "C:\" &#124; find /V """"<br>    (Default)    REG_SZ    C:\Program Files\VMware\VMware Tools\TPVCGateway.exe<br>    (Default)    REG_SZ    C:\Program Files\VMware\VMware Tools\VMwareCplLauncher.exe<br>    (Default)    REG_SZ    C:\Program Files\Internet Explorer\iexplore.exe<br>    LocalizedString    REG_SZ    @C:\Program Files\VMware\VMware Tools\VMwareHostOpen.exe,-1008<br>    (Default)    REG_SZ    C:\Program Files\VMware\VMware Tools\VMwareHostOpen.exe,-101<br>    (Default)    REG_SZ    C:\Program Files\Internet Explorer\IEXPLORE.EXE<br>    (Default)    REG_SZ    C:\Program Files\VMware\VMware Tools\VMwareTray.exe<br>    627BF46A150AF194A92056AAE2EFA363    REG_SZ    C:\Program Files\VMware\VMware Tools\rpctool.exe<br>    627BF46A150AF194A92056AAE2EFA363    REG_SZ    C:\Program Files\VMware\VMware Tools\VMwareCplLauncher.exe<br>    627BF46A150AF194A92056AAE2EFA363    REG_SZ    C:\Program Files\VMware\VMware Tools\VMwareToolboxCmd.exe<br>    627BF46A150AF194A92056AAE2EFA363    REG_SZ    C:\Program Files\VMware\VMware Tools\unzip.exe<br>    627BF46A150AF194A92056AAE2EFA363    REG_SZ    C:\Program Files\VMware\VMware Tools\vmtoolsd.exe<br>    627BF46A150AF194A92056AAE2EFA363    REG_SZ    C:\Program Files\Common Files\VMware\Drivers\vss\comreg.exe</code></div> |
| `c:\windows\system32\gathernetworkinfo.vbs` | **Win7 Only** Script included gathers data about the system and stores output in files in the c:\windows\system32\config directory. External link [here.](http://www.verboon.info/index.php/2011/06/the-gathernetworkinfo-vbs-script/) | |
| `echo %COMSPEC%%` | Determine the location of the command line interpreter such as cmd.exe. | **Win2008** <div class="slide" style="cursor: pointer;">Show/Hide</div><div class="view"><code>C:\Users\johndoe>echo %COMSPEC%<br>C:\Windows\system32\cmd.exe</code></div> |
| `gpresult /z` | Extremely verbose output of GPO (Group policy) settings as applied to the current system and user. | **Win2008** <div class="slide" style="cursor: pointer;">Show/Hide</div><div class="view"><code>C:\Users\johndoe>gpresult /z<br><br>Microsoft (R) Windows (R) Operating System Group Policy Result tool v2.0<br>Copyright (C) Microsoft Corp. 1981-2001<br><br>Created On 10/15/2013 at 7:02:05 PM<br><br><br>RSOP data for LAB\johndoe on WIN-0P19ULL2NB6 : Logging Mode<br>------------------------------------------------------------<br><br>OS Configuration:            Primary Domain Controller<br>OS Version:                  6.0.6002<br>Site Name:                   N/A<br>Roaming Profile:             N/A<br>Local Profile:               C:\Users\johndoe<br>Connected over a slow link?: No<br><br><br>USER SETTINGS<br>--------------<br>    CN=johndoe,CN=Users,DC=lab,DC=sky,DC=net<br>    Last time Group Policy was applied: 10/12/2013 at 6:20:23 PM<br>    Group Policy was applied from:      WIN-0P19ULL2NB6.lab.sky.net<br>    Group Policy slow link threshold:   500 kbps<br>    Domain Name:                        LAB<br>    Domain Type:                        Windows 2000<br><br>    Applied Group Policy Objects<br>    -----------------------------<br>        N/A<br><br>    The following GPOs were not applied because they were filtered out<br>    -------------------------------------------------------------------<br>        Local Group Policy<br>            Filtering:  Not Applied (Empty)<br><br>        Default Domain Policy<br>            Filtering:  Not Applied (Empty)<br><br>    The user is a part of the following security groups<br>    ---------------------------------------------------<br>        Domain Users<br>        Everyone<br>        BUILTIN\Users<br>        BUILTIN\Administrators<br>        BUILTIN\Pre-Windows 2000 Compatible Access<br>        NT AUTHORITY\INTERACTIVE<br>        NT AUTHORITY\Authenticated Users<br>        This Organization<br>        LOCAL<br>        High Mandatory Level<br><br>    The user has the following security privileges<br>    ----------------------------------------------<br><br><br>    Resultant Set Of Policies for User<br>    -----------------------------------</code></div> |
| `set` | Dumps the environment variables for the current user. Very helpful command. | **Win2008** <div class="slide" style="cursor: pointer;">Show/Hide</div><div class="view"><code>C:\Users\johndoe>set<br>ALLUSERSPROFILE=C:\ProgramData<br>APPDATA=C:\Users\johndoe\AppData\Roaming<br>CommonProgramFiles=C:\Program Files\Common Files<br>COMPUTERNAME=WIN-0P19ULL2NB6<br>ComSpec=C:\Windows\system32\cmd.exe<br>DFSTRACINGON=FALSE<br>FP_NO_HOST_CHECK=NO<br>HOMEDRIVE=C:<br>HOMEPATH=\Users\johndoe<br>LOCALAPPDATA=C:\Users\johndoe\AppData\Local<br>LOGONSERVER=\\WIN-0P19ULL2NB6<br>OS=Windows_NT<br>Path=C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem<br>PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC<br>PROCESSOR_ARCHITECTURE=x86<br>PROCESSOR_IDENTIFIER=x86 Family 6 Model 42 Stepping 7, GenuineIntel<br>PROCESSOR_LEVEL=6<br>PROCESSOR_REVISION=2a07<br>ProgramData=C:\ProgramData<br>ProgramFiles=C:\Program Files<br>PROMPT=$P$G<br>PUBLIC=C:\Users\Public<br>SESSIONNAME=Console<br>SystemDrive=C:<br>SystemRoot=C:\Windows<br>TEMP=C:\Users\johndoe\AppData\Local\Temp\1<br>TMP=C:\Users\johndoe\AppData\Local\Temp\1<br>TRACE_FORMAT_SEARCH_PATH=\\winseqfe\release\Windows6.0\lh_sp2rtm\6002.18005.090410-1830\x86fre\symbols.pri\TraceFormat<br>USERDNSDOMAIN=LAB.SKY.NET<br>USERDOMAIN=LAB<br>USERNAME=johndoe<br>USERPROFILE=C:\Users\johndoe<br>windir=C:\Windows</code></div> |
| `type %WINDIR%\System32\drivers\etc\hosts` | Show the contents of the system's host file which does the local translation of IP address to hostname. This file may contain important servers. | **Win2008** <div class="slide" style="cursor: pointer;">Show/Hide</div><div class="view"><code>C:\Users\johndoe>type %WINDIR%\System32\drivers\etc\hosts<br># Copyright (c) 1993-2006 Microsoft Corp.<br>#<br># This is a sample HOSTS file used by Microsoft TCP/IP for Windows.<br>#<br># This file contains the mappings of IP addresses to host names. Each<br># entry should be kept on an individual line. The IP address should<br># be placed in the first column followed by the corresponding host name.<br># The IP address and the host name should be separated by at least one<br># space.<br>#<br># Additionally, comments (such as these) may be inserted on individual<br># lines or following the machine name denoted by a '#' symbol.<br>#<br># For example:<br>#<br>#      102.54.94.97     rhino.acme.com          # source server<br>#       38.25.63.10     x.acme.com              # x client host<br><br>127.0.0.1       localhost<br>::1             localhost</code></div> |

## Registry
For more information: http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/reg.mspx?mfr=true or http://www.petri.co.il/reg_command_in_windows_xp.htm

| Command | Expected Output | 
| ------- | --------------- |
| `reg save [HIVE] [OUTFILE]` | **Must be run as an administrator.** Saves part of the registry to a file. Replace [HIVE] with HKLM\Security, HKLM\System, or HKLM\SAM and [OUTFILE] with the name of the file you would like to save the registry in. |
| `reg add [\\TargetIPaddr\] [RegDomain\Key]` | Adds a key to target machine's registry. Replace [\\TargetIPaddr] with your target system, [RegDomain\Key] with the registry domain and key you'd like to insert. |
| `reg export [RegDomain\Key] [OUTFILE]` | Exports a key to a file. Replace [RegDomain\Key] with the registry domain and key you'd like to insert and [OUTFILE] with the name of the file you would like to save the registry key in. |
| `reg import [INFILE]`	| Imports content to target machine's registry. Replace [INFILE] with the file that has the content you wish to insert.	|
| `reg query [\\TargetIPaddr\] [RegDomain\Key] /v [ValueName]` | Retrieves a key and value from target machine's registry. Replace [\\TargetIPaddr] with your target system, [RegDomain\Key] with the registry domain and key you'd like to query. |

## sc
For more information: http://technet.microsoft.com/en-us/library/bb490995.aspx

| Command | Expected Output | 
| ------- | --------------- |
| `sc qc [servicename]` | sc.exe retrieves and sets control information about services. You can use sc.exe for testing and debugging service programs. Things to look at here are the path to the executable, the start type (does it start at boot or on demand?), and service names. |
| `sc query [servicename]` | This shows the status of the [servicename] queried. |
| `sc queryex [servicename]` | Shows the extended status (such as the Process ID) of the [servicename]. |

## wmi

For more information: http://msdn.microsoft.com/en-us/library/aa394531(v=vs.85).aspx and https://isc.sans.edu/diary/Windows+Command-Line+Kung+Fu+with+WMIC/1229. For most of these commands you can add list full to the end and retrieve the data in a non-table format. Sometimes this view is easier to read.

| Command | Expected Output | 
| ------- | --------------- |
| `wmic bios` | Retrieves BIOS information including system serial number. |
| `wmic qfe get hotfixid` | Retrieves patch IDs |
| `wmic startup list full` | Shows startup items, which user runs them and full paths to the executables. |
| `wmic service list full` | Retrieves ton of information about all the services installed on the system. |
| `wmic process get caption,executablepath,commandline` | Retrieves process names, captions, executable paths and command line flags. |
| `wmic process call create [EXECUTABLE]` | Launches an executable. Replace [EXECUTABLE] with the name of the executable you'd like to launch (for example: calc.exe). Do not include quotes around the value (for example: DO use calc.exe; do NOT use "calc.exe") |
| `wmic process where name="[PROCESS]" call terminate` | Terminates a process. Replace [PROCESS] with the name of the process you'd like to terminate and you DO need the quotes around it (for example: calc.exe) |
| `wmic logicaldisk where drivetype=3 get name, freespace, systemname, filesystem, size, volumeserialnumber` | Retrieve information about the harddrive. |
| `wmic useraccount list full` | Retrieve information about the user accounts on the system. |
| `wmic share` | Retrieve information about local shares. | 